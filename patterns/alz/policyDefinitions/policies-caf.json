{
  "$schema": "https://schema.management.azure.com/schemas/2019-08-01/managementGroupDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.26.54.24096",
      "templateHash": "5306286930982275072"
    }
  },
  "parameters": {
    "topLevelManagementGroupPrefix": {
      "type": "string",
      "defaultValue": "alz",
      "metadata": {
        "message": "The JSON version of this file is programatically generated from Bicep. PLEASE DO NOT UPDATE MANUALLY!!",
        "description": "Provide a prefix (unique at tenant-scope) for the Management Group hierarchy and other resources created as part of an Azure landing zone. DEFAULT VALUE = \"alz\""
      }
    },
    "location": {
      "type": "string",
      "defaultValue": "[deployment().location]",
      "metadata": {
        "description": "Optionally set the deployment location for policies with Deploy If Not Exists effect. DEFAULT VALUE = \"deployment().location\""
      }
    },
    "scope": {
      "type": "string",
      "defaultValue": "[tenantResourceId('Microsoft.Management/managementGroups', parameters('topLevelManagementGroupPrefix'))]",
      "metadata": {
        "description": "Optionally set the scope for custom Policy Definitions used in Policy Set Definitions (Initiatives). Must be one of '/', '/subscriptions/id' or '/providers/Microsoft.Management/managementGroups/id'. DEFAULT VALUE = '/providers/Microsoft.Management/managementGroups/${topLevelManagementGroupPrefix}'"
      }
    }
  },
  "variables": {
    "copy": [
      {
        "name": "processPolicyDefinitionsAll",
        "count": "[length(variables('loadPolicyDefinitions').All)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').All[copyIndex('processPolicyDefinitionsAll')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureCloud[copyIndex('processPolicyDefinitionsAzureCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicyDefinitions').AzureChinaCloud)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureChinaCloud[copyIndex('processPolicyDefinitionsAzureChinaCloud')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicyDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicyDefinitions').AzureUSGovernment)]",
        "input": "[replace(replace(variables('loadPolicyDefinitions').AzureUSGovernment[copyIndex('processPolicyDefinitionsAzureUSGovernment')], variables('templateVars').defaultDeploymentLocation, variables('deploymentLocation')), variables('templateVars').localizedDeploymentLocation, variables('deploymentLocation'))]"
      },
      {
        "name": "processPolicySetDefinitionsAll",
        "count": "[length(variables('loadPolicySetDefinitions').All)]",
        "input": "[replace(variables('loadPolicySetDefinitions').All[copyIndex('processPolicySetDefinitionsAll')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureCloud[copyIndex('processPolicySetDefinitionsAzureCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('loadPolicySetDefinitions').AzureChinaCloud)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureChinaCloud[copyIndex('processPolicySetDefinitionsAzureChinaCloud')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "processPolicySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('loadPolicySetDefinitions').AzureUSGovernment)]",
        "input": "[replace(variables('loadPolicySetDefinitions').AzureUSGovernment[copyIndex('processPolicySetDefinitionsAzureUSGovernment')], variables('templateVars').scope, parameters('scope'))]"
      },
      {
        "name": "policyDefinitionsAll",
        "count": "[length(variables('processPolicyDefinitionsAll'))]",
        "input": "[json(variables('processPolicyDefinitionsAll')[copyIndex('policyDefinitionsAll')])]"
      },
      {
        "name": "policyDefinitionsAzureCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureCloud')[copyIndex('policyDefinitionsAzureCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicyDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureChinaCloud')[copyIndex('policyDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policyDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicyDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicyDefinitionsAzureUSGovernment')[copyIndex('policyDefinitionsAzureUSGovernment')])]"
      },
      {
        "name": "policySetDefinitionsAll",
        "count": "[length(variables('processPolicySetDefinitionsAll'))]",
        "input": "[json(variables('processPolicySetDefinitionsAll')[copyIndex('policySetDefinitionsAll')])]"
      },
      {
        "name": "policySetDefinitionsAzureCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureCloud')[copyIndex('policySetDefinitionsAzureCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureChinaCloud",
        "count": "[length(variables('processPolicySetDefinitionsAzureChinaCloud'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureChinaCloud')[copyIndex('policySetDefinitionsAzureChinaCloud')])]"
      },
      {
        "name": "policySetDefinitionsAzureUSGovernment",
        "count": "[length(variables('processPolicySetDefinitionsAzureUSGovernment'))]",
        "input": "[json(variables('processPolicySetDefinitionsAzureUSGovernment')[copyIndex('policySetDefinitionsAzureUSGovernment')])]"
      }
    ],
    "$fxv#0": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_AlertProcessing_Rule\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AMBA Notification Assets\",\r\n    \"description\": \"Policy to deploy Action Group and Alert Processing Rule for all AMBA alerts\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.3\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"rg-amba-monitoring-001\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"ALZMonitorActionGroupEmail\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Action Group Email Addresses\",\r\n          \"description\": \"Email addresses to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"action@mail.com\"\r\n      },\r\n      \"ALZLogicappResourceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Logic App Resource Id\",\r\n          \"description\": \"Logic App Resource Id for Action Group to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZLogicappCallbackUrl\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Logic App Callback URL\",\r\n          \"description\": \"Callback URL that triggers the Logic App\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZArmRoleId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Arm Role Id\",\r\n          \"description\": \"Arm Built-in Role Id for action group to send alerts to a subscription level, will only send to individual members of role\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZEventHubResourceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Event Hub\",\r\n          \"description\": \"Event Hub resource id for action group to send alerts to a subscription level\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZWebhookServiceUri\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Webhook Service Uri\",\r\n          \"description\": \"Indicates the service uri of the webhook to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZFunctionResourceId\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Function Resource Id\",\r\n          \"description\": \"Function Resource Id for Action Group to send alerts to\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"ALZFunctionTriggerUrl\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Function Trigger URL\",\r\n          \"description\": \"URL that triggers the Function\"\r\n        },\r\n        \"defaultValue\": \"\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitoring disabled\",\r\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.AlertsManagement/actionRules/description\",\r\n                \"equals\": \"AMBA Notification Assets - Alert Processing Rule for Subscription\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"ALZMonitorResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorActionGroupEmail\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZLogicappResourceId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZLogicappCallbackUrl\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"ALZArmRoleId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZEventHubResourceId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZWebhookServiceUri\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZFunctionResourceId\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZFunctionTriggerUrl\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                  \"varALZMonitorActionGroupEmail\": \"[[array(split(parameters('ALZMonitorActionGroupEmail'),','))]\",\r\n                  \"varALZArmRoleId\": \"[[array(split(parameters('ALZArmRoleId'),','))]\",\r\n                  \"varALZEventHubResourceId\": \"[[array(split(parameters('ALZEventHubResourceId'),','))]\",\r\n                  \"varALZWebhookServiceUri\": \"[[array(split(parameters('ALZWebhookServiceUri'),','))]\",\r\n                  \"varLogicAppReceivers\": [\r\n                    {\r\n                      \"name\": \"AlzLA-0\",\r\n                      \"resourceId\": \"[[if(empty(parameters('ALZLogicappResourceId')), null(), trim(parameters('ALZLogicappResourceId')))]\",\r\n                      \"callbackUrl\": \"[[if(empty(parameters('ALZLogicappCallbackUrl')), null(), trim(parameters('ALZLogicappCallbackUrl')))]\",\r\n                      \"useCommonSchema\": true\r\n                    }\r\n                  ],\r\n                  \"varAzureFunctionReceivers\": [\r\n                    {\r\n                      \"name\": \"AlzFa-0\",\r\n                      \"functionAppResourceId\": \"[[if(empty(parameters('ALZFunctionResourceId')), null(), split(trim(parameters('ALZFunctionResourceId')),'/functions/')[0])]\",\r\n                      \"functionName\": \"[[if(empty(parameters('ALZFunctionResourceId')), null(), split(trim(parameters('ALZFunctionResourceId')),'/')[10])]\",\r\n                      \"httpTriggerUrl\": \"[[if(empty(parameters('ALZFunctionTriggerUrl')), null(), trim(parameters('ALZFunctionTriggerUrl')))]\",\r\n                      \"useCommonAlertSchema\": true\r\n                    }\r\n                  ],\r\n                  \"copy\": [\r\n                    {\r\n                      \"name\": \"varArmRoleReceivers\",\r\n                      \"count\": \"[[length(variables('varALZArmRoleId'))]\",\r\n                      \"mode\": \"serial\",\r\n                      \"input\": {\r\n                        \"name\": \"[[concat('AlzARM-', indexOf(variables('varALZArmRoleId'), variables('varALZArmRoleId')[copyIndex('varArmRoleReceivers')]))]\",\r\n                        \"roleId\": \"[[trim(variables('varALZArmRoleId')[copyIndex('varArmRoleReceivers')])]\",\r\n                        \"useCommonSchema\": true\r\n                      }\r\n                    },\r\n                    {\r\n                      \"name\": \"varEventHubReceivers\",\r\n                      \"count\": \"[[length(variables('varALZEventHubResourceId'))]\",\r\n                      \"mode\": \"serial\",\r\n                      \"input\": {\r\n                        \"name\": \"[[concat('AlzEH-', indexOf(variables('varALZEventHubResourceId'), variables('varALZEventHubResourceId')[copyIndex('varEventHubReceivers')]))]\",\r\n                        \"subscriptionId\": \"[[if(empty(parameters('ALZEventHubResourceId')), null(), split(trim(variables('varALZEventHubResourceId')[copyIndex('varEventHubReceivers')]),'/')[2])]\",\r\n                        \"eventHubNameSpace\": \"[[if(empty(parameters('ALZEventHubResourceId')), null(), split(trim(variables('varALZEventHubResourceId')[copyIndex('varEventHubReceivers')]),'/')[8])]\",\r\n                        \"eventHubName\": \"[[if(empty(parameters('ALZEventHubResourceId')), null(), split(trim(variables('varALZEventHubResourceId')[copyIndex('varEventHubReceivers')]),'/')[10])]\",\r\n                        \"useCommonAlertSchema\": true,\r\n                        \"tenantId\": \"[[subscription().tenantId]\"\r\n                      }\r\n                    },\r\n                    {\r\n                      \"name\": \"varWebhookReceivers\",\r\n                      \"count\": \"[[length(variables('varALZWebhookServiceUri'))]\",\r\n                      \"mode\": \"serial\",\r\n                      \"input\": {\r\n                        \"name\": \"[[concat('AlzWh-', indexOf(variables('varALZWebhookServiceUri'), variables('varALZWebhookServiceUri')[copyIndex('varWebhookReceivers')]))]\",\r\n                        \"identifierUri\": \"null()\",\r\n                        \"objectId\": \"null()\",\r\n                        \"serviceUri\": \"[[trim(variables('varALZWebhookServiceUri')[copyIndex('varWebhookReceivers')])]\",\r\n                        \"useCommonAlertSchema\": true,\r\n                        \"tenantId\": \"null()\",\r\n                        \"useAadAuth\": \"false\"\r\n                      }\r\n                    }\r\n                  ]\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('ALZMonitorResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"ActionGroupDeployment\",\r\n                    \"resourceGroup\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('ALZMonitorResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"ALZMonitorResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZMonitorActionGroupEmail\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZLogicappResourceId\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZLogicappCallbackUrl\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZArmRoleId\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZEventHubResourceId\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZWebhookServiceUri\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZFunctionResourceId\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"ALZFunctionTriggerUrl\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/actionGroups\",\r\n                            \"apiVersion\": \"2023-01-01\",\r\n                            \"name\": \"[[concat('ag-AMBA-', subscription().displayName, '-001')]\",\r\n                            \"location\": \"Global\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"groupShortName\": \"ActGrp\",\r\n                              \"enabled\": true,\r\n                              \"copy\": [\r\n                                {\r\n                                  \"name\": \"emailReceivers\",\r\n                                  \"count\": \"[[length(variables('varALZMonitorActionGroupEmail'))]\",\r\n                                  \"mode\": \"serial\",\r\n                                  \"input\": {\r\n                                    \"name\": \"[[concat('AlzMail-', indexOf(variables('varALZMonitorActionGroupEmail'), variables('varALZMonitorActionGroupEmail')[copyIndex('emailReceivers')]))]\",\r\n                                    \"emailAddress\": \"[[trim(variables('varALZMonitorActionGroupEmail')[copyIndex('emailReceivers')])]\",\r\n                                    \"useCommonSchema\": true\r\n                                  }\r\n                                }\r\n                              ],\r\n                              \"armRoleReceivers\": \"[[if(empty(parameters('ALZArmRoleId')), null(), variables('varArmRoleReceivers'))]\",\r\n                              \"logicAppReceivers\": \"[[if(empty(parameters('ALZLogicappResourceId')), null(), variables('varLogicAppReceivers'))]\",\r\n                              \"eventHubReceivers\": \"[[if(empty(parameters('ALZEventHubResourceId')), null(), variables('varEventHubReceivers'))]\",\r\n                              \"webhookReceivers\": \"[[if(empty(parameters('ALZWebhookServiceUri')), null(), variables('varWebhookReceivers'))]\",\r\n                              \"azureFunctionReceivers\": \"[[if(empty(parameters('ALZFunctionResourceId')), null(), variables('varAzureFunctionReceivers'))]\"\r\n                            }\r\n                          },\r\n                          {\r\n                            \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n                            \"apiVersion\": \"2021-08-08\",\r\n                            \"name\": \"[[concat('apr-AMBA-',subscription().displayName, '-001')]\",\r\n                            \"location\": \"Global\",\r\n                            \"dependsOn\": [\r\n                              \"[[concat('ag-AMBA-', subscription().displayName, '-001')]\"\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"description\": \"AMBA Notification Assets - Alert Processing Rule for Subscription\",\r\n                              \"enabled\": true,\r\n                              \"actions\": [\r\n                                {\r\n                                  \"actiongroupIds\": [\r\n                                    \"[[concat(subscription().Id, '/resourceGroups/', parameters('ALZMonitorResourceGroupName'), '/providers/microsoft.insights/actionGroups/', 'ag-AMBA-', subscription().displayName, '-001')]\"\r\n                                  ],\r\n                                  \"actionType\": \"AddActionGroups\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"ALZMonitorResourceGroupName\": {\r\n                          \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                        },\r\n                        \"ALZMonitorActionGroupEmail\": {\r\n                          \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                        },\r\n                        \"ALZLogicappResourceId\": {\r\n                          \"value\": \"[[parameters('ALZLogicappResourceId')]\"\r\n                        },\r\n                        \"ALZLogicappCallbackUrl\": {\r\n                          \"value\": \"[[parameters('ALZLogicappCallbackUrl')]\"\r\n                        },\r\n                        \"ALZArmRoleId\": {\r\n                          \"value\": \"[[parameters('ALZArmRoleId')]\"\r\n                        },\r\n                        \"ALZEventHubResourceId\": {\r\n                          \"value\": \"[[parameters('ALZEventHubResourceId')]\"\r\n                        },\r\n                        \"ALZWebhookServiceUri\": {\r\n                          \"value\": \"[[parameters('ALZWebhookServiceUri')]\"\r\n                        },\r\n                        \"ALZFunctionResourceId\": {\r\n                          \"value\": \"[[parameters('ALZFunctionResourceId')]\"\r\n                        },\r\n                        \"ALZFunctionTriggerUrl\": {\r\n                          \"value\": \"[[parameters('ALZFunctionTriggerUrl')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"ALZMonitorResourceGroupName\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n                },\r\n                \"ALZMonitorActionGroupEmail\": {\r\n                  \"value\": \"[[parameters('ALZMonitorActionGroupEmail')]\"\r\n                },\r\n                \"ALZLogicappResourceId\": {\r\n                  \"value\": \"[[parameters('ALZLogicappResourceId')]\"\r\n                },\r\n                \"ALZLogicappCallbackUrl\": {\r\n                  \"value\": \"[[parameters('ALZLogicappCallbackUrl')]\"\r\n                },\r\n                \"ALZArmRoleId\": {\r\n                  \"value\": \"[[parameters('ALZArmRoleId')]\"\r\n                },\r\n                \"ALZEventHubResourceId\": {\r\n                  \"value\": \"[[parameters('ALZEventHubResourceId')]\"\r\n                },\r\n                \"ALZWebhookServiceUri\": {\r\n                  \"value\": \"[[parameters('ALZWebhookServiceUri')]\"\r\n                },\r\n                \"ALZFunctionResourceId\": {\r\n                  \"value\": \"[[parameters('ALZFunctionResourceId')]\"\r\n                },\r\n                \"ALZFunctionTriggerUrl\": {\r\n                  \"value\": \"[[parameters('ALZFunctionTriggerUrl')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#1": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_Suppression_AlertProcessing_Rule\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy AMBA Notification Suppression Asset\",\r\n    \"description\": \"Policy to deploy empty and disabled suppression Alert Processing Rule for all AMBA alerts\",\r\n    \"metadata\": {\r\n      \"version\": \"1.0.0\",\r\n      \"category\": \"Monitoring\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"ALZMonitorResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"rg-amba-monitoring-001\"\r\n      },\r\n      \"ALZMonitorResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"_deployed_by_amba\": true\r\n        }\r\n      },\r\n      \"ALZMonitorResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Monitoring disabled\",\r\n          \"description\": \"Tag name to disable monitoring. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Resources/subscriptions\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"deployIfNotExists\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n          \"existenceScope\": \"resourceGroup\",\r\n          \"resourceGroupName\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.AlertsManagement/actionRules/description\",\r\n                \"equals\": \"AMBA Notification Assets - Suppression Alert Processing Rule for maintenance period for Subscription\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"ALZMonitorResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"ALZMonitorResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  }\r\n                },\r\n                \"variables\": {\r\n                },\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('ALZMonitorResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"SuppressionRuleDeployment\",\r\n                    \"resourceGroup\": \"[[parameters('ALZMonitorResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('ALZMonitorResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"ALZMonitorResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.AlertsManagement/actionRules\",\r\n                            \"apiVersion\": \"2021-08-08\",\r\n                            \"name\": \"[[concat('apr-AMBA-',subscription().displayName, '-002')]\",\r\n                            \"location\": \"Global\",\r\n                            \"dependsOn\": [\r\n                            ],\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"description\": \"AMBA Notification Assets - Suppression Alert Processing Rule for maintenance period for Subscription\",\r\n                              \"enabled\": false,\r\n                              \"actions\": [\r\n                                {\r\n                                  \"actionType\": \"RemoveAllActionGroups\"\r\n                                }\r\n                              ]\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"ALZMonitorResourceGroupName\": {\r\n                          \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"ALZMonitorResourceGroupName\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupName')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupTags')]\"\r\n                },\r\n                \"ALZMonitorResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('ALZMonitorResourceGroupLocation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#10": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskreadLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Read Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskreadLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskreadLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskreadLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskreadLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#11": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskSpace_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Space Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskSpace Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskSpaceAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskSpaceAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskSpace\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#12": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_OSDiskwriteLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM OS Disk Write Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM OSDiskwriteLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"50\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"C:\",\r\n          \"/\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMOSDiskwriteLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowOSDiskwriteLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine OSDiskwriteLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#13": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_CPU_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM CPU Alert\",\r\n    \"description\": \"Policy to audit/deploy VM CPU Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"85\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"1\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Processor\\\" and Name == \\\"UtilizationPercentage\\\"| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMCPUAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighCPUAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine CPU\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Processor\\\" and Name == \\\"UtilizationPercentage\\\"| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"1\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#14": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_Memory_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Memory Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Memory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"|where Namespace == \\\"Memory\\\" and Name == \\\"AvailableMB\\\"| extend TotalMemory = toreal(todynamic(Tags)[\\\"vm.azm.ms/memorySizeMB\\\"]) | extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMMemoryAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowMemoryAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine Memory\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"|where Namespace == \\\"Memory\\\" and Name == \\\"AvailableMB\\\"| extend TotalMemory = toreal(todynamic(Tags)[\\\"vm.azm.ms/memorySizeMB\\\"]) | extend AvailableMemoryPercentage = (toreal(Val) / TotalMemory) * 100.0| summarize AggregatedValue = avg(AvailableMemoryPercentage) by bin(TimeGenerated, 15m), Computer, _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#15": {
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2021-06-01",
      "name": "Alerting-LandingZone",
      "properties": {
        "displayName": "Fork Azure Monitor Baseline Alerts for Landing Zone",
        "description": "Initiative to deploy AMBA alerts relevant to the ALZ LandingZone management group",
        "metadata": {
          "version": "1.0.5",
          "category": "Monitoring",
          "source": "https://github.com/Azure/azure-monitor-baseline-alerts/",
          "alzCloudEnvironments": [
            "AzureCloud"
          ],
          "_deployed_by_amba": true
        },
        "parameters": {
          "ALZMonitorResourceGroupName": {
            "type": "String",
            "defaultValue": "ALZ-Monitoring-RG",
            "metadata": {
              "displayName": "ALZ Monitor Resource Group Name",
              "description": "Name of the resource group where the ALZ Monitor resources will be deployed"
            }
          },
          "ALZMonitorResourceGroupTags": {
            "type": "Object",
            "defaultValue": {
              "_deployed_by_alz_monitor": true
            },
            "metadata": {
              "displayName": "ALZ Monitor Resource Group Tags",
              "description": "Tags for the resource group where the ALZ Monitor resources will be deployed"
            }
          },
          "ALZMonitorResourceGroupLocation": {
            "type": "String",
            "defaultValue": "centralus",
            "metadata": {
              "displayName": "ALZ Monitor Resource Group Location",
              "description": "Location of the resource group where the ALZ Monitor resources will be deployed"
            }
          },
          "VMHeartBeatRGAlertSeverity": {
            "type": "String",
            "defaultValue": "1",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Alert Severity",
              "description": "Severity of the alert for VM Heart Beat RG"
            }
          },
          "VMHeartBeatRGWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMHeartBeatRGEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMHeartBeatRGAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Heart Beat RG Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMHeartBeatRGAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Heart Beat RG Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMHeartBeatRGAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Heart Beat RG Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMHeartBeatRGPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMHeartBeatRGAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Heart Beat RG Alert State",
              "description": "Alert state for the alert"
            }
          },
          "VMHeartBeatRGThreshold": {
            "type": "string",
            "defaultValue": "10",
            "metadata": {
              "displayName": "VM Heart Beat RG Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMHeartBeatRGOperator": {
            "type": "string",
            "defaultValue": "GreaterThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Operator",
              "description": "Operator for the alert"
            }
          },
          "VMHeartBeatRGTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Heart Beat RG Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMNetworkInAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Network In Alert Severity",
              "description": "Severity of the alert for VM Network In"
            }
          },
          "VMNetworkInWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Network In Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMNetworkInEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Network In Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMNetworkInAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network In Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMNetworkInAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network In Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMNetworkInAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Network In Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMNetworkInPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Network In Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMNetworkInAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network In Alert State",
              "description": "Alert state for the alert"
            }
          },
          "VMNetworkInThreshold": {
            "type": "string",
            "defaultValue": "10000000",
            "metadata": {
              "displayName": "VM Network In Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMNetworkInOperator": {
            "type": "string",
            "defaultValue": "GreaterThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Network In Operator",
              "description": "Operator for the alert"
            }
          },
          "VMNetworkInTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Network In Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMNetworkInEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Network In Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMNetworkInFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Network In Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMNetworkInComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Network In Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMNetworkInNetworkInterfaceToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Network In Network Interface To Include",
              "description": "Network Interface To Include for the alert"
            }
          },
          "VMNetworkOutAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Network Out Alert Severity",
              "description": "Severity of the alert for VM Network Out"
            }
          },
          "VMNetworkOutWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Network Out Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMNetworkOutEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Network Out Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMNetworkOutAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network Out Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMNetworkOutAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network Out Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMNetworkOutAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Network Out Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMNetworkOutPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Network Out Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMNetworkOutAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Network Out Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMNetworkOutThreshold": {
            "type": "string",
            "defaultValue": "10000000",
            "metadata": {
              "displayName": "VM Network Out Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMNetworkOutOperator": {
            "type": "string",
            "defaultValue": "GreaterThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Network Out Operator",
              "description": "Operator for the alert"
            }
          },
          "VMNetworkOutTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Network Out Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMNetworkOutEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Network Out Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMNetworkOutFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Network Out Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMNetworkOutComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Network Out Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMNetworkOutNetworkInterfaceToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Network Out Network Interface To Include",
              "description": "Network Interface To Include for the alert"
            }
          },
          "VMOSDiskReadLatencyAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Alert Severity",
              "description": "Severity of the alert for VM OS Disk Read Latency"
            }
          },
          "VMOSDiskReadLatencyWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMOSDiskReadLatencyEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMOSDiskReadLatencyAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMOSDiskReadLatencyAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMOSDiskReadLatencyAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMOSDiskReadLatencyPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMOSDiskReadLatencyAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMOSDiskReadLatencyThreshold": {
            "type": "string",
            "defaultValue": "30",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMOSDiskReadLatencyOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Operator",
              "description": "Operator for the alert"
            }
          },
          "VMOSDiskReadLatencyTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMOSDiskReadLatencyEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMOSDiskReadLatencyFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Read Latency Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMOSDiskReadLatencyComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMOSDiskReadLatencyDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "C:",
              "/"
            ],
            "metadata": {
              "displayName": "VM OS Disk Read Latency Disks To Include",
              "description": "Disks To Include for the alert"
            }
          },
          "VMOSDiskWriteLatencyAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Alert Severity",
              "description": "Severity of the alert for VM OS Disk Write Latency"
            }
          },
          "VMOSDiskWriteLatencyWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMOSDiskWriteLatencyEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMOSDiskWriteLatencyAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMOSDiskWriteLatencyAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMOSDiskWriteLatencyAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMOSDiskWriteLatencyPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMOSDiskWriteLatencyAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMOSDiskWriteLatencyThreshold": {
            "type": "string",
            "defaultValue": "50",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMOSDiskWriteLatencyOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Operator",
              "description": "Operator for the alert"
            }
          },
          "VMOSDiskWriteLatencyTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMOSDiskWriteLatencyEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMOSDiskWriteLatencyFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Write Latency Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMOSDiskWriteLatencyComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMOSDiskWriteLatencyDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "C:",
              "/"
            ],
            "metadata": {
              "displayName": "VM OS Disk Write Latency Disks To Include",
              "description": "Disks To Include for the alert"
            }
          },
          "VMOSDiskSpaceAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Alert Severity",
              "description": "Severity of the alert for VM OS Disk Space"
            }
          },
          "VMOSDiskSpaceWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMOSDiskSpaceEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMOSDiskSpaceAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Space Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMOSDiskSpaceAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Space Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMOSDiskSpaceAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM OS Disk Space Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMOSDiskSpacePolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMOSDiskSpaceAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM OS Disk Space Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMOSDiskSpaceThreshold": {
            "type": "string",
            "defaultValue": "10",
            "metadata": {
              "displayName": "VM OS Disk Space Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMOSDiskSpaceOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Operator",
              "description": "Operator for the alert"
            }
          },
          "VMOSDiskSpaceTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMOSDiskSpaceEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Space Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMOSDiskSpaceFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM OS Disk Space Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMOSDiskSpaceComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMOSDiskSpaceDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "C:",
              "/"
            ],
            "metadata": {
              "displayName": "VM OS Disk Space Disks To Include",
              "description": "Disks To Include for the alert"
            }
          },
          "VMPercentCPUAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Alert Severity",
              "description": "Severity of the alert for VM Percent CPU"
            }
          },
          "VMPercentCPUWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMPercentCPUEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMPercentCPUAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent CPU Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMPercentCPUAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent CPU Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMPercentCPUAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Percent CPU Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMPercentCPUPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMPercentCPUAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent CPU Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMPercentCPUThreshold": {
            "type": "string",
            "defaultValue": "85",
            "metadata": {
              "displayName": "VM Percent CPU Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMPercentCPUOperator": {
            "type": "string",
            "defaultValue": "GreaterThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Operator",
              "description": "Operator for the alert"
            }
          },
          "VMPercentCPUTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Percent CPU Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMPercentMemoryAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Alert Severity",
              "description": "Severity of the alert for VM Percent Memory"
            }
          },
          "VMPercentMemoryWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMPercentMemoryEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMPercentMemoryAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent Memory Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMPercentMemoryAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent Memory Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMPercentMemoryAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Percent Memory Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMPercentMemoryPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMPercentMemoryAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Percent Memory Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMPercentMemoryThreshold": {
            "type": "string",
            "defaultValue": "10",
            "metadata": {
              "displayName": "VM Percent Memory Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMPercentMemoryOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Operator",
              "description": "Operator for the alert"
            }
          },
          "VMPercentMemoryTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Percent Memory Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMDataDiskSpaceAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Alert Severity",
              "description": "Severity of the alert for VM Data Disk Space"
            }
          },
          "VMDataDiskSpaceWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMDataDiskSpaceEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMDataDiskSpaceAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Space Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMDataDiskSpaceAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Space Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMDataDiskSpaceAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Data Disk Space Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMDataDiskSpacePolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMDataDiskSpaceAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Space Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMDataDiskSpaceThreshold": {
            "type": "string",
            "defaultValue": "10",
            "metadata": {
              "displayName": "VM Data Disk Space Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMDataDiskSpaceOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Operator",
              "description": "Operator for the alert"
            }
          },
          "VMDataDiskSpaceTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMDataDiskSpaceEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Space Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMDataDiskSpaceFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Space Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMDataDiskSpaceDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Data Disk Space Disks To Include",
              "description": "Disks To Include for the alert"
            }
          },
          "VMDataDiskReadLatencyAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Alert Severity",
              "description": "Severity of the alert for VM Data Disk Read Latency"
            }
          },
          "VMDataDiskReadLatencyWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMDataDiskReadLatencyEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMDataDiskReadLatencyAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMDataDiskReadLatencyAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMDataDiskReadLatencyAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMDataDiskReadLatencyPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMDataDiskReadLatencyAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMDataDiskReadLatencyThreshold": {
            "type": "string",
            "defaultValue": "30",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMDataDiskReadLatencyOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Operator",
              "description": "Operator for the alert"
            }
          },
          "VMDataDiskReadLatencyTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMDataDiskReadLatencyEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMDataDiskReadLatencyFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Read Latency Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMDataDiskReadLatencyComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMDataDiskReadLatencyDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Data Disk Read Latency Disks To Include",
              "description": "Disks To Include for the alert"
            }
          },
          "VMDataDiskWriteLatencyAlertSeverity": {
            "type": "String",
            "defaultValue": "2",
            "allowedValues": [
              "0",
              "1",
              "2",
              "3",
              "4"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Alert Severity",
              "description": "Severity of the alert for VM Data Disk Write Latency"
            }
          },
          "VMDataDiskWriteLatencyWindowSize": {
            "type": "string",
            "defaultValue": "PT15M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H",
              "PT6H",
              "PT12H",
              "P1D"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Window Size",
              "description": "Window size for the alert"
            }
          },
          "VMDataDiskWriteLatencyEvaluationFrequency": {
            "type": "string",
            "defaultValue": "PT5M",
            "allowedValues": [
              "PT1M",
              "PT5M",
              "PT15M",
              "PT30M",
              "PT1H"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Evaluation Frequency",
              "description": "Evaluation frequency for the alert"
            }
          },
          "VMDataDiskWriteLatencyAutoMitigate": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Auto Mitigate",
              "description": "Auto Mitigate for the alert"
            }
          },
          "VMDataDiskWriteLatencyAutoResolve": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Auto Resolve",
              "description": "Auto Resolve for the alert"
            }
          },
          "VMDataDiskWriteLatencyAutoResolveTime": {
            "type": "string",
            "defaultValue": "00:10:00",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Auto Resolve Time",
              "description": "Auto Resolve Time for the alert"
            }
          },
          "VMDataDiskWriteLatencyPolicyEffect": {
            "type": "string",
            "defaultValue": "deployIfNotExists",
            "allowedValues": [
              "deployIfNotExists",
              "disabled"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Policy Effect",
              "description": "Policy effect for the alert, deployIfNotExists will deploy the alert if it does not exist"
            }
          },
          "VMDataDiskWriteLatencyAlertState": {
            "type": "string",
            "defaultValue": "true",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Alert State",
              "description": "Alert state for the alert, true will enable the alert, false will disable the alert"
            }
          },
          "VMDataDiskWriteLatencyThreshold": {
            "type": "string",
            "defaultValue": "30",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Threshold",
              "description": "Threshold for the alert"
            }
          },
          "VMDataDiskWriteLatencyOperator": {
            "type": "string",
            "defaultValue": "LessThan",
            "allowedValues": [
              "Equals",
              "GreaterThan",
              "GreaterThanOrEqual",
              "LessThan",
              "LessThanOrEqual"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Operator",
              "description": "Operator for the alert"
            }
          },
          "VMDataDiskWriteLatencyTimeAggregation": {
            "type": "string",
            "defaultValue": "Average",
            "allowedValues": [
              "Average",
              "Count",
              "Maximum",
              "Minimum",
              "Total"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Time Aggregation",
              "description": "Time Aggregation for the alert"
            }
          },
          "VMDataDiskWriteLatencyEvaluationPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Evaluation Periods",
              "description": "Evaluation Periods for the alert"
            }
          },
          "VMDataDiskWriteLatencyFailingPeriods": {
            "type": "string",
            "defaultValue": "1",
            "metadata": {
              "displayName": "VM Data Disk Write Latency Failing Periods",
              "description": "Failing Periods for the alert"
            }
          },
          "VMDataDiskWriteLatencyComputersToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Computers To Include",
              "description": "Computers To Include for the alert"
            }
          },
          "VMDataDiskWriteLatencyDisksToInclude": {
            "type": "array",
            "defaultValue": [
              "*"
            ],
            "metadata": {
              "displayName": "VM Data Disk Write Latency Disks To Include",
              "description": "Disks To Include for the alert"
            }
          }
        },
        "policyDefinitions": [
          {
            "policyDefinitionReferenceId": "ALZ_VMHeartBeatRG",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_HeartBeat_Alert",
            "parameters": {
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              },
              "severity": {
                "value": "[[[parameters('VMHeartBeatRGAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMHeartBeatRGWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMHeartBeatRGEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMHeartBeatRGAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMHeartBeatRGAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMHeartBeatRGAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMHeartBeatRGPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMHeartBeatRGAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMHeartBeatRGThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMHeartBeatRGOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMHeartBeatRGTimeAggregation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMNetworkIn",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkIn_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMNetworkInAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMNetworkInWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMNetworkInEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMNetworkInAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMNetworkInAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMNetworkInAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMNetworkInPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMNetworkInAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMNetworkInThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMNetworkInOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMNetworkInTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMNetworkInFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMNetworkInEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMNetworkInComputersToInclude')]"
              },
              "networkInterfacesToInclude": {
                "value": "[[[parameters('VMNetworkInNetworkInterfaceToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMNetworkOut",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_NetworkOut_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMNetworkOutAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMNetworkOutWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMNetworkOutEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMNetworkOutAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMNetworkOutAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMNetworkOutAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMNetworkOutPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMNetworkOutAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMNetworkOutThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMNetworkOutOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMNetworkOutTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMNetworkOutFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMNetworkOutEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMNetworkOutComputersToInclude')]"
              },
              "networkInterfacesToInclude": {
                "value": "[[[parameters('VMNetworkOutNetworkInterfaceToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMOSDiskReadLatency",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskreadLatency_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMOSDiskReadLatencyAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMOSDiskReadLatencyWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMOSDiskReadLatencyEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMOSDiskReadLatencyAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMOSDiskReadLatencyAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMOSDiskReadLatencyAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMOSDiskReadLatencyPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMOSDiskReadLatencyAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMOSDiskReadLatencyThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMOSDiskReadLatencyOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMOSDiskReadLatencyTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMOSDiskReadLatencyFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMOSDiskReadLatencyEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMOSDiskReadLatencyComputersToInclude')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMOSDiskReadLatencyDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMOSDiskWriteLatency",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskwriteLatency_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMOSDiskWriteLatencyAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMOSDiskWriteLatencyWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMOSDiskWriteLatencyEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMOSDiskWriteLatencyAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMOSDiskWriteLatencyAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMOSDiskWriteLatencyAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMOSDiskWriteLatencyPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMOSDiskWriteLatencyAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMOSDiskWriteLatencyThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMOSDiskWriteLatencyOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMOSDiskWriteLatencyTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMOSDiskWriteLatencyFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMOSDiskWriteLatencyEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMOSDiskWriteLatencyComputersToInclude')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMOSDiskWriteLatencyDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMOSDiskSpace",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_OSDiskSpace_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMOSDiskSpaceAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMOSDiskSpaceWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMOSDiskSpaceEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMOSDiskSpaceAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMOSDiskSpaceAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMOSDiskSpaceAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMOSDiskSpacePolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMOSDiskSpaceAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMOSDiskSpaceThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMOSDiskSpaceOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMOSDiskSpaceTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMOSDiskSpaceFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMOSDiskSpaceEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMOSDiskSpaceComputersToInclude')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMOSDiskSpaceDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMPercentCPU",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_CPU_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMPercentCPUAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMPercentCPUWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMPercentCPUEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMPercentCPUAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMPercentCPUAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMPercentCPUAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMPercentCPUPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMPercentCPUAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMPercentCPUThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMPercentCPUOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMPercentCPUTimeAggregation')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMPercentMemory",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_Memory_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMPercentMemoryAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMPercentMemoryWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMPercentMemoryEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMPercentMemoryAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMPercentMemoryAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMPercentMemoryAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMPercentMemoryPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMPercentMemoryAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMPercentMemoryThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMPercentMemoryOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMPercentMemoryTimeAggregation')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMDataDiskSpace",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskSpace_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMDataDiskSpaceAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMDataDiskSpaceWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMDataDiskSpaceEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMDataDiskSpaceAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMDataDiskSpaceAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMDataDiskSpaceAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMDataDiskSpacePolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMDataDiskSpaceAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMDataDiskSpaceThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMDataDiskSpaceOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMDataDiskSpaceTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMDataDiskSpaceFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMDataDiskSpaceEvaluationPeriods')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMDataDiskSpaceDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMDataDiskReadLatency",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskReadLatency_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMDataDiskReadLatencyAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMDataDiskReadLatencyWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMDataDiskReadLatencyEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMDataDiskReadLatencyAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMDataDiskReadLatencyAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMDataDiskReadLatencyAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMDataDiskReadLatencyPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMDataDiskReadLatencyAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMDataDiskReadLatencyThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMDataDiskReadLatencyOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMDataDiskReadLatencyTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMDataDiskReadLatencyFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMDataDiskReadLatencyEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMDataDiskReadLatencyComputersToInclude')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMDataDiskReadLatencyDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          },
          {
            "policyDefinitionReferenceId": "ALZ_VMDataDiskWriteLatency",
            "policyDefinitionId": "/providers/Microsoft.Management/managementGroups/contoso/providers/Microsoft.Authorization/policyDefinitions/Deploy_VM_dataDiskWriteLatency_Alert",
            "parameters": {
              "severity": {
                "value": "[[[parameters('VMDataDiskWriteLatencyAlertSeverity')]"
              },
              "windowSize": {
                "value": "[[[parameters('VMDataDiskWriteLatencyWindowSize')]"
              },
              "evaluationFrequency": {
                "value": "[[[parameters('VMDataDiskWriteLatencyEvaluationFrequency')]"
              },
              "autoMitigate": {
                "value": "[[[parameters('VMDataDiskWriteLatencyAutoMitigate')]"
              },
              "autoResolve": {
                "value": "[[[parameters('VMDataDiskWriteLatencyAutoResolve')]"
              },
              "autoResolveTime": {
                "value": "[[[parameters('VMDataDiskWriteLatencyAutoResolveTime')]"
              },
              "effect": {
                "value": "[[[parameters('VMDataDiskWriteLatencyPolicyEffect')]"
              },
              "enabled": {
                "value": "[[[parameters('VMDataDiskWriteLatencyAlertState')]"
              },
              "threshold": {
                "value": "[[[parameters('VMDataDiskWriteLatencyThreshold')]"
              },
              "operator": {
                "value": "[[[parameters('VMDataDiskWriteLatencyOperator')]"
              },
              "timeAggregation": {
                "value": "[[[parameters('VMDataDiskWriteLatencyTimeAggregation')]"
              },
              "failingPeriods": {
                "value": "[[[parameters('VMDataDiskWriteLatencyFailingPeriods')]"
              },
              "evaluationPeriods": {
                "value": "[[[parameters('VMDataDiskWriteLatencyEvaluationPeriods')]"
              },
              "computersToInclude": {
                "value": "[[[parameters('VMDataDiskWriteLatencyComputersToInclude')]"
              },
              "disksToInclude": {
                "value": "[[[parameters('VMDataDiskWriteLatencyDisksToInclude')]"
              },
              "alertResourceGroupName": {
                "value": "[[[parameters('ALZMonitorResourceGroupName')]"
              },
              "alertResourceGroupTags": {
                "value": "[[[parameters('ALZMonitorResourceGroupTags')]"
              },
              "alertResourceGroupLocation": {
                "value": "[[[parameters('ALZMonitorResourceGroupLocation')]"
              }
            }
          }
        ],
        "policyType": "Custom",
        "policyDefinitionGroups": null
      }
    },
    "$fxv#2": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_AvailableMemory_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Available Memory Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Available Memory Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"P1D\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT1M\",\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"1000\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"disabled\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/metricAlerts\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricNamespace\",\r\n                \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].metricName\",\r\n                \"equals\": \"Available Memory Bytes\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name, '/providers/Microsoft.Compute/virtualMachines/', field('fullName'))]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricalerts/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"Average\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].operator\",\r\n                \"equals\": \"LessThan\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/metricAlerts/criteria.Microsoft-Azure-Monitor-SingleResourceMultipleMetricCriteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"resourceName\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceName\",\r\n                      \"description\": \"Name of the resource\"\r\n                    }\r\n                  },\r\n                  \"resourceId\": {\r\n                    \"type\": \"String\",\r\n                    \"metadata\": {\r\n                      \"displayName\": \"resourceId\",\r\n                      \"description\": \"Resource ID of the resource emitting the metric that will be used for the comparison\"\r\n                    }\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/metricAlerts\",\r\n                    \"apiVersion\": \"2018-03-01\",\r\n                    \"name\": \"[[concat(parameters('resourceName'), '-AvailableMemoryAlert')]\",\r\n                    \"location\": \"global\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"description\": \"Metric Alert for Virtual Machine Available Memory (MBytes)\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[parameters('resourceId')]\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"name\": \"Average_AvailableMBytes\",\r\n                            \"metricNamespace\": \"Microsoft.Compute/virtualMachines\",\r\n                            \"metricName\": \"Available Memory Bytes\",\r\n                            \"operator\": \"LessThan\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"timeAggregation\": \"Average\",\r\n                            \"criterionType\": \"StaticThresholdCriterion\"\r\n                          }\r\n                        ],\r\n                        \"odata.type\": \"Microsoft.Azure.Monitor.SingleResourceMultipleMetricCriteria\"\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"resourceName\": {\r\n                  \"value\": \"[[field('name')]\"\r\n                },\r\n                \"resourceId\": {\r\n                  \"value\": \"[[field('id')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#3": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskReadLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Read Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM dataDiskReadLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Computers to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskReadLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskReadLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskReadLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"ReadLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#4": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskSpace_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Space Alert\",\r\n    \"description\": \"Policy to audit/deploy VM data Disk Space Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"LessThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both Windows and Linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskSpaceAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMLowdataDiskSpaceAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskSpace\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"FreeSpacePercentage\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#5": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_dataDiskWriteLatency_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Data Disk Write Latency Alert\",\r\n    \"description\": \"Policy to audit/deploy VM dataDiskWriteLatency Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"30\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Computers to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"disksToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Disks to be included to be monitored\",\r\n          \"description\": \"Array of disk to be monitored for disk both windows and linux\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"disksToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMdataDiskWriteLatencyAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighdataDiskWriteLatencyAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine dataDiskWriteLatency\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"LogicalDisk\\\" and Name == \\\"WriteLatencyMs\\\"| extend Disk=tostring(todynamic(Tags)[\\\"vm.azm.ms/mountId\\\"])|where Disk !in ('C:','/')| summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, Disk\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"Disk\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('disksToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"disksToInclude\": {\r\n                                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"disksToInclude\": {\r\n                  \"value\": \"[[parameters('disksToInclude')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#6": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_HeartBeat_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\r\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for all VMs in the subscription\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"HeartBeatAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHeartBeatAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine Heartbeat\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": [\r\n                                          \"*\"\r\n                                        ]\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#7": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_HeartBeat_Alert_RG\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM HeartBeat Alert\",\r\n    \"description\": \"Policy to audit/deploy VM HeartBeat Alert for VMs in the resource group\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10\"\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      },\r\n      \"MonitorDisable\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Tag name to disable monitoring resource. Set to true if monitoring should be disabled\"\r\n        },\r\n        \"defaultValue\": \"MonitorDisable\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          },\r\n          {\r\n            \"field\": \"[[concat('tags[', parameters('MonitorDisable'), ']')]\",\r\n            \"notEquals\": \"true\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[concat(subscription().id, '/resourceGroups/', resourceGroup().name)]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"1\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"1\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                    \"apiVersion\": \"2022-08-01-preview\",\r\n                    \"name\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                    \"location\": \"[[resourceGroup().location]\",\r\n                    \"tags\": {\r\n                      \"_deployed_by_amba\": true\r\n                    },\r\n                    \"properties\": {\r\n                      \"displayName\": \"[[concat(resourceGroup().name, '-VMHeartBeatAlert')]\",\r\n                      \"description\": \"Log Alert for Virtual Machine Heartbeat\",\r\n                      \"severity\": \"[[parameters('severity')]\",\r\n                      \"enabled\": \"[[parameters('enabled')]\",\r\n                      \"scopes\": [\r\n                        \"[[resourceGroup().Id]\"\r\n                      ],\r\n                      \"targetResourceTypes\": [\r\n                        \"Microsoft.Compute/virtualMachines\"\r\n                      ],\r\n                      \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                      \"windowSize\": \"[[parameters('windowSize')]\",\r\n                      \"criteria\": {\r\n                        \"allOf\": [\r\n                          {\r\n                            \"query\": \"Heartbeat| summarize TimeGenerated=max(TimeGenerated) by Computer, _ResourceId| extend Duration = datetime_diff('minute',now(),TimeGenerated)| summarize AggregatedValue = min(Duration) by Computer, bin(TimeGenerated,5m), _ResourceId\",\r\n                            \"metricMeasureColumn\": \"AggregatedValue\",\r\n                            \"threshold\": \"[[parameters('threshold')]\",\r\n                            \"operator\": \"[[parameters('operator')]\",\r\n                            \"resourceIdColumn\": \"_ResourceId\",\r\n                            \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                            \"dimensions\": [\r\n                              {\r\n                                \"name\": \"Computer\",\r\n                                \"operator\": \"Include\",\r\n                                \"values\": [\r\n                                  \"*\"\r\n                                ]\r\n                              }\r\n                            ],\r\n                            \"failingPeriods\": {\r\n                              \"numberOfEvaluationPeriods\": 1,\r\n                              \"minFailingPeriodsToAlert\": 1\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                      \"ruleResolveConfiguration\": {\r\n                        \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                        \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                      },\r\n                      \"parameters\": {\r\n                        \"severity\": {\r\n                          \"value\": \"[[parameters('severity')]\"\r\n                        },\r\n                        \"windowSize\": {\r\n                          \"value\": \"[[parameters('windowSize')]\"\r\n                        },\r\n                        \"evaluationFrequency\": {\r\n                          \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                        },\r\n                        \"autoMitigate\": {\r\n                          \"value\": \"[[parameters('autoMitigate')]\"\r\n                        },\r\n                        \"autoResolve\": {\r\n                          \"value\": \"[[parameters('autoResolve')]\"\r\n                        },\r\n                        \"autoResolveTime\": {\r\n                          \"value\": \"[[parameters('autoResolveTime')]\"\r\n                        },\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"threshold\": {\r\n                          \"value\": \"[[parameters('threshold')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#8": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_NetworkIn_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Network Read Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Nework Read Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"networkInterfacesToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Network Interface to be included to be monitored\",\r\n          \"description\": \"Array of Network Interface to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Computers to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"ReadBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"networkInterfacesToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMNetworkInAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworkInAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine NetworkIn\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"ReadBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"NetworkInterface\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                },\r\n                                \"networkInterfacesToInclude\": {\r\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                },\r\n                \"networkInterfacesToInclude\": {\r\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "$fxv#9": "{\r\n  \"type\": \"Microsoft.Authorization/policyDefinitions\",\r\n  \"apiVersion\": \"2021-06-01\",\r\n  \"name\": \"Deploy_VM_NetworkOut_Alert\",\r\n  \"properties\": {\r\n    \"policyType\": \"Custom\",\r\n    \"mode\": \"All\",\r\n    \"displayName\": \"Deploy VM Network Write Alert\",\r\n    \"description\": \"Policy to audit/deploy VM Network Out Alert\",\r\n    \"metadata\": {\r\n      \"version\": \"1.1.0\",\r\n      \"category\": \"Compute\",\r\n      \"source\": \"https://github.com/Azure/azure-monitor-baseline-alerts/\",\r\n      \"alzCloudEnvironments\": [\r\n        \"AzureCloud\"\r\n      ],\r\n      \"_deployed_by_amba\": \"True\"\r\n    },\r\n    \"parameters\": {\r\n      \"alertResourceGroupName\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Name\",\r\n          \"description\": \"Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"AlzMonitoring-rg\"\r\n      },\r\n      \"alertResourceGroupTags\": {\r\n        \"type\": \"Object\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Tags\",\r\n          \"description\": \"Tags on the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": {\r\n          \"environment\": \"test\"\r\n        }\r\n      },\r\n      \"alertResourceGroupLocation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Resource Group Location\",\r\n          \"description\": \"Location of the Resource group the alert is placed in\"\r\n        },\r\n        \"defaultValue\": \"centralus\"\r\n      },\r\n      \"severity\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Severity\",\r\n          \"description\": \"Severity of the Alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"0\",\r\n          \"1\",\r\n          \"2\",\r\n          \"3\",\r\n          \"4\"\r\n        ],\r\n        \"defaultValue\": \"2\"\r\n      },\r\n      \"operator\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Operator\"\r\n        },\r\n        \"allowedvalues\": [\r\n          \"Equals\",\r\n          \"GreaterThan\",\r\n          \"GreaterThanOrEqual\",\r\n          \"LessThan\",\r\n          \"LessThanOrEqual\"\r\n        ],\r\n        \"defaultvalue\": \"GreaterThan\"\r\n      },\r\n      \"timeAggregation\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"TimeAggregation\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"Average\",\r\n          \"Count\",\r\n          \"Maximum\",\r\n          \"Minimum\",\r\n          \"Total\"\r\n        ],\r\n        \"defaultvalue\": \"Average\"\r\n      },\r\n      \"windowSize\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Window Size\",\r\n          \"description\": \"Window size for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\",\r\n          \"PT6H\",\r\n          \"PT12H\",\r\n          \"PT24H\"\r\n        ],\r\n        \"defaultValue\": \"PT15M\"\r\n      },\r\n      \"evaluationFrequency\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Frequency\",\r\n          \"description\": \"Evaluation frequency for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"PT5M\",\r\n          \"PT15M\",\r\n          \"PT30M\",\r\n          \"PT1H\"\r\n        ],\r\n        \"defaultValue\": \"PT5M\"\r\n      },\r\n      \"autoMitigate\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Mitigate\",\r\n          \"description\": \"Auto Mitigate for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolve\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"autoResolveTime\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Auto Resolve\",\r\n          \"description\": \"Auto Resolve time for the alert in ISO 8601 format\"\r\n        },\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"enabled\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Alert State\",\r\n          \"description\": \"Alert state for the alert\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"true\",\r\n          \"false\"\r\n        ],\r\n        \"defaultValue\": \"true\"\r\n      },\r\n      \"threshold\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Threshold\",\r\n          \"description\": \"Threshold for the alert\"\r\n        },\r\n        \"defaultValue\": \"10000000\"\r\n      },\r\n      \"failingPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Failing Periods\",\r\n          \"description\": \"Number of failing periods before alert is fired\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"evaluationPeriods\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Evaluation Periods\",\r\n          \"description\": \"The number of aggregated lookback points.\"\r\n        },\r\n        \"defaultValue\": \"1\"\r\n      },\r\n      \"computersToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Computers to be included to be monitored\",\r\n          \"description\": \"Array of Computer to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"networkInterfacesToInclude\": {\r\n        \"type\": \"array\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Network Interface to be included to be monitored\",\r\n          \"description\": \"Array of Network Interface to be monitored\"\r\n        },\r\n        \"defaultValue\": [\r\n          \"*\"\r\n        ]\r\n      },\r\n      \"effect\": {\r\n        \"type\": \"String\",\r\n        \"metadata\": {\r\n          \"displayName\": \"Effect\",\r\n          \"description\": \"Effect of the policy\"\r\n        },\r\n        \"allowedValues\": [\r\n          \"deployIfNotExists\",\r\n          \"disabled\"\r\n        ],\r\n        \"defaultValue\": \"deployIfNotExists\"\r\n      }\r\n    },\r\n    \"policyRule\": {\r\n      \"if\": {\r\n        \"allOf\": [\r\n          {\r\n            \"field\": \"type\",\r\n            \"equals\": \"Microsoft.Compute/virtualMachines\"\r\n          }\r\n        ]\r\n      },\r\n      \"then\": {\r\n        \"effect\": \"[[parameters('effect')]\",\r\n        \"details\": {\r\n          \"roleDefinitionIds\": [\r\n            \"/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c\"\r\n          ],\r\n          \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n          \"existenceScope\": \"resourcegroup\",\r\n          \"resourceGroupName\": \"[[parameters('alertResourceGroupName')]\",\r\n          \"deploymentScope\": \"subscription\",\r\n          \"existenceCondition\": {\r\n            \"allOf\": [\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/displayName\",\r\n                \"equals\": \"[[concat(subscription().displayName, '-VMHighNetworkOutAlert')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/scopes[*]\",\r\n                \"equals\": \"[[subscription().id]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/enabled\",\r\n                \"equals\": \"[[parameters('enabled')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/evaluationFrequency\",\r\n                \"equals\": \"[[parameters('evaluationFrequency')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/windowSize\",\r\n                \"equals\": \"[[parameters('windowSize')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/severity\",\r\n                \"equals\": \"[[parameters('severity')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledqueryrules/autoMitigate\",\r\n                \"equals\": \"[[parameters('autoMitigate')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].threshold\",\r\n                \"equals\": \"[[parameters('threshold')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].operator\",\r\n                \"equals\": \"[[parameters('operator')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].timeAggregation\",\r\n                \"equals\": \"[[parameters('timeAggregation')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.numberOfEvaluationPeriods\",\r\n                \"equals\": \"[[parameters('evaluationPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].failingPeriods.minFailingPeriodsToAlert\",\r\n                \"equals\": \"[[parameters('failingPeriods')]\"\r\n              },\r\n              {\r\n                \"field\": \"Microsoft.Insights/scheduledQueryRules/criteria.allOf[*].query\",\r\n                \"equals\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"WriteBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\"\r\n              }\r\n            ]\r\n          },\r\n          \"deployment\": {\r\n            \"location\": \"northeurope\",\r\n            \"properties\": {\r\n              \"mode\": \"incremental\",\r\n              \"template\": {\r\n                \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                \"contentVersion\": \"1.0.0.0\",\r\n                \"parameters\": {\r\n                  \"alertResourceGroupName\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"alertResourceGroupTags\": {\r\n                    \"type\": \"object\"\r\n                  },\r\n                  \"alertResourceGroupLocation\": {\r\n                    \"type\": \"string\"\r\n                  },\r\n                  \"severity\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"windowSize\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationFrequency\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoMitigate\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolve\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"autoResolveTime\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"enabled\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"threshold\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"operator\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"timeAggregation\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"failingPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"evaluationPeriods\": {\r\n                    \"type\": \"String\"\r\n                  },\r\n                  \"computersToInclude\": {\r\n                    \"type\": \"array\"\r\n                  },\r\n                  \"networkInterfacesToInclude\": {\r\n                    \"type\": \"array\"\r\n                  }\r\n                },\r\n                \"variables\": {},\r\n                \"resources\": [\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/resourceGroups\",\r\n                    \"apiVersion\": \"2021-04-01\",\r\n                    \"name\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                    \"tags\": \"[[parameters('alertResourceGroupTags')]\"\r\n                  },\r\n                  {\r\n                    \"type\": \"Microsoft.Resources/deployments\",\r\n                    \"apiVersion\": \"2019-10-01\",\r\n                    \"name\": \"VMNetworkOutAlert\",\r\n                    \"resourceGroup\": \"[[parameters('alertResourceGroupName')]\",\r\n                    \"dependsOn\": [\r\n                      \"[[concat('Microsoft.Resources/resourceGroups/', parameters('alertResourceGroupName'))]\"\r\n                    ],\r\n                    \"properties\": {\r\n                      \"mode\": \"Incremental\",\r\n                      \"template\": {\r\n                        \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n                        \"contentVersion\": \"1.0.0.0\",\r\n                        \"parameters\": {\r\n                          \"enabled\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupName\": {\r\n                            \"type\": \"string\"\r\n                          },\r\n                          \"alertResourceGroupLocation\": {\r\n                            \"type\": \"string\"\r\n                          }\r\n                        },\r\n                        \"variables\": {},\r\n                        \"resources\": [\r\n                          {\r\n                            \"type\": \"Microsoft.Insights/scheduledQueryRules\",\r\n                            \"apiVersion\": \"2022-08-01-preview\",\r\n                            \"name\": \"[[concat(subscription().displayName, '-VMHighNetworkOutAlert')]\",\r\n                            \"location\": \"[[parameters('alertResourceGroupLocation')]\",\r\n                            \"tags\": {\r\n                              \"_deployed_by_amba\": true\r\n                            },\r\n                            \"properties\": {\r\n                              \"displayName\": \"[[concat(subscription().displayName, '-VMHighNetworkOutAlert')]\",\r\n                              \"description\": \"Log Alert for Virtual Machine NetworkOut\",\r\n                              \"severity\": \"[[parameters('severity')]\",\r\n                              \"enabled\": \"[[parameters('enabled')]\",\r\n                              \"scopes\": [\r\n                                \"[[subscription().Id]\"\r\n                              ],\r\n                              \"targetResourceTypes\": [\r\n                                \"Microsoft.Compute/virtualMachines\"\r\n                              ],\r\n                              \"evaluationFrequency\": \"[[parameters('evaluationFrequency')]\",\r\n                              \"windowSize\": \"[[parameters('windowSize')]\",\r\n                              \"criteria\": {\r\n                                \"allOf\": [\r\n                                  {\r\n                                    \"query\": \"InsightsMetrics| where Origin == \\\"vm.azm.ms\\\"| where Namespace == \\\"Network\\\" and Name == \\\"WriteBytesPerSecond\\\"| extend NetworkInterface=tostring(todynamic(Tags)[\\\"vm.azm.ms/networkDeviceId\\\"])|summarize AggregatedValue = avg(Val) by bin(TimeGenerated, 15m), Computer, _ResourceId, NetworkInterface\",\r\n                                    \"metricMeasureColumn\": \"AggregatedValue\",\r\n                                    \"threshold\": \"[[parameters('threshold')]\",\r\n                                    \"operator\": \"[[parameters('operator')]\",\r\n                                    \"resourceIdColumn\": \"_ResourceId\",\r\n                                    \"timeAggregation\": \"[[parameters('timeAggregation')]\",\r\n                                    \"dimensions\": [\r\n                                      {\r\n                                        \"name\": \"Computer\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('computersToInclude')]\"\r\n                                      },\r\n                                      {\r\n                                        \"name\": \"NetworkInterface\",\r\n                                        \"operator\": \"Include\",\r\n                                        \"values\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                      }\r\n                                    ],\r\n                                    \"failingPeriods\": {\r\n                                      \"numberOfEvaluationPeriods\": \"[[parameters('evaluationPeriods')]\",\r\n                                      \"minFailingPeriodsToAlert\": \"[[parameters('failingPeriods')]\"\r\n                                    }\r\n                                  }\r\n                                ]\r\n                              },\r\n                              \"autoMitigate\": \"[[parameters('autoMitigate')]\",\r\n                              \"ruleResolveConfiguration\": {\r\n                                \"autoResolved\": \"[[parameters('autoResolve')]\",\r\n                                \"timeToResolve\": \"[[parameters('autoResolveTime')]\"\r\n                              },\r\n                              \"parameters\": {\r\n                                \"alertResourceGroupName\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"alertResourceGroupLocation\": {\r\n                                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                                },\r\n                                \"severity\": {\r\n                                  \"value\": \"[[parameters('severity')]\"\r\n                                },\r\n                                \"windowSize\": {\r\n                                  \"value\": \"[[parameters('windowSize')]\"\r\n                                },\r\n                                \"evaluationFrequency\": {\r\n                                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                                },\r\n                                \"autoMitigate\": {\r\n                                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                                },\r\n                                \"autoResolve\": {\r\n                                  \"value\": \"[[parameters('autoResolve')]\"\r\n                                },\r\n                                \"autoResolveTime\": {\r\n                                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                                },\r\n                                \"enabled\": {\r\n                                  \"value\": \"[[parameters('enabled')]\"\r\n                                },\r\n                                \"threshold\": {\r\n                                  \"value\": \"[[parameters('threshold')]\"\r\n                                },\r\n                                \"failingPeriods\": {\r\n                                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                                },\r\n                                \"evaluationPeriods\": {\r\n                                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                                },\r\n                                \"computersToInclude\": {\r\n                                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                                },\r\n                                \"networkInterfacesToInclude\": {\r\n                                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                                }\r\n                              }\r\n                            }\r\n                          }\r\n                        ]\r\n                      },\r\n                      \"parameters\": {\r\n                        \"enabled\": {\r\n                          \"value\": \"[[parameters('enabled')]\"\r\n                        },\r\n                        \"alertResourceGroupName\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                        },\r\n                        \"alertResourceGroupLocation\": {\r\n                          \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                        }\r\n                      }\r\n                    }\r\n                  }\r\n                ]\r\n              },\r\n              \"parameters\": {\r\n                \"alertResourceGroupName\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupName')]\"\r\n                },\r\n                \"alertResourceGroupTags\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupTags')]\"\r\n                },\r\n                \"alertResourceGroupLocation\": {\r\n                  \"value\": \"[[parameters('alertResourceGroupLocation')]\"\r\n                },\r\n                \"severity\": {\r\n                  \"value\": \"[[parameters('severity')]\"\r\n                },\r\n                \"windowSize\": {\r\n                  \"value\": \"[[parameters('windowSize')]\"\r\n                },\r\n                \"evaluationFrequency\": {\r\n                  \"value\": \"[[parameters('evaluationFrequency')]\"\r\n                },\r\n                \"autoMitigate\": {\r\n                  \"value\": \"[[parameters('autoMitigate')]\"\r\n                },\r\n                \"autoResolve\": {\r\n                  \"value\": \"[[parameters('autoResolve')]\"\r\n                },\r\n                \"autoResolveTime\": {\r\n                  \"value\": \"[[parameters('autoResolveTime')]\"\r\n                },\r\n                \"enabled\": {\r\n                  \"value\": \"[[parameters('enabled')]\"\r\n                },\r\n                \"threshold\": {\r\n                  \"value\": \"[[parameters('threshold')]\"\r\n                },\r\n                \"operator\": {\r\n                  \"value\": \"[[parameters('operator')]\"\r\n                },\r\n                \"timeAggregation\": {\r\n                  \"value\": \"[[parameters('timeAggregation')]\"\r\n                },\r\n                \"failingPeriods\": {\r\n                  \"value\": \"[[parameters('failingPeriods')]\"\r\n                },\r\n                \"evaluationPeriods\": {\r\n                  \"value\": \"[[parameters('evaluationPeriods')]\"\r\n                },\r\n                \"computersToInclude\": {\r\n                  \"value\": \"[[parameters('computersToInclude')]\"\r\n                },\r\n                \"networkInterfacesToInclude\": {\r\n                  \"value\": \"[[parameters('networkInterfacesToInclude')]\"\r\n                }\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n",
    "cloudEnv": "[environment().name]",
    "defaultDeploymentLocationByCloudType": {
      "AzureCloud": "northeurope",
      "AzureChinaCloud": "chinaeast2",
      "AzureUSGovernment": "usgovvirginia"
    },
    "templateVars": {
      "scope": "/providers/Microsoft.Management/managementGroups/contoso",
      "defaultDeploymentLocation": "\"location\": \"northeurope\"",
      "localizedDeploymentLocation": "[format('\"location\": \"{0}\"', variables('defaultDeploymentLocationByCloudType')[variables('cloudEnv')])]"
    },
    "targetDeploymentLocationByCloudType": {
      "AzureCloud": "[coalesce(parameters('location'), 'northeurope')]",
      "AzureChinaCloud": "[coalesce(parameters('location'), 'chinaeast2')]",
      "AzureUSGovernment": "[coalesce(parameters('location'), 'usgovvirginia')]"
    },
    "deploymentLocation": "[format('\"location\": \"{0}\"', variables('targetDeploymentLocationByCloudType')[variables('cloudEnv')])]",
    "loadPolicyDefinitions": {
      "All": [
        "[variables('$fxv#0')]",
        "[variables('$fxv#1')]",
        "[variables('$fxv#2')]",
        "[variables('$fxv#3')]",
        "[variables('$fxv#4')]",
        "[variables('$fxv#5')]",
        "[variables('$fxv#6')]",
        "[variables('$fxv#7')]",
        "[variables('$fxv#8')]",
        "[variables('$fxv#9')]",
        "[variables('$fxv#10')]",
        "[variables('$fxv#11')]",
        "[variables('$fxv#12')]",
        "[variables('$fxv#13')]",
        "[variables('$fxv#14')]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "loadPolicySetDefinitions": {
      "All": [
        "[string(variables('$fxv#15'))]"
      ],
      "AzureCloud": [],
      "AzureChinaCloud": [],
      "AzureUSGovernment": []
    },
    "policyDefinitionsByCloudType": {
      "All": "[variables('policyDefinitionsAll')]",
      "AzureCloud": "[variables('policyDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policyDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policyDefinitionsAzureUSGovernment')]"
    },
    "policySetDefinitionsByCloudType": {
      "All": "[variables('policySetDefinitionsAll')]",
      "AzureCloud": "[variables('policySetDefinitionsAzureCloud')]",
      "AzureChinaCloud": "[variables('policySetDefinitionsAzureChinaCloud')]",
      "AzureUSGovernment": "[variables('policySetDefinitionsAzureUSGovernment')]"
    },
    "policyDefinitions": "[concat(variables('policyDefinitionsByCloudType').All, variables('policyDefinitionsByCloudType')[variables('cloudEnv')])]",
    "policySetDefinitions": "[concat(variables('policySetDefinitionsByCloudType').All, variables('policySetDefinitionsByCloudType')[variables('cloudEnv')])]"
  },
  "resources": [
    {
      "copy": {
        "name": "PolicyDefinitions",
        "count": "[length(variables('policyDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policyDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policyDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policyDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policyDefinitions')[copyIndex()].properties.metadata]",
        "mode": "[variables('policyDefinitions')[copyIndex()].properties.mode]",
        "parameters": "[variables('policyDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policyDefinitions')[copyIndex()].properties.policyType]",
        "policyRule": "[variables('policyDefinitions')[copyIndex()].properties.policyRule]"
      }
    },
    {
      "copy": {
        "name": "PolicySetDefinitions",
        "count": "[length(variables('policySetDefinitions'))]"
      },
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2020-09-01",
      "name": "[variables('policySetDefinitions')[copyIndex()].name]",
      "properties": {
        "description": "[variables('policySetDefinitions')[copyIndex()].properties.description]",
        "displayName": "[variables('policySetDefinitions')[copyIndex()].properties.displayName]",
        "metadata": "[variables('policySetDefinitions')[copyIndex()].properties.metadata]",
        "parameters": "[variables('policySetDefinitions')[copyIndex()].properties.parameters]",
        "policyType": "[variables('policySetDefinitions')[copyIndex()].properties.policyType]",
        "policyDefinitions": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitions]",
        "policyDefinitionGroups": "[variables('policySetDefinitions')[copyIndex()].properties.policyDefinitionGroups]"
      },
      "dependsOn": [
        "PolicyDefinitions"
      ]
    }
  ],
  "outputs": {
    "policyDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policyDefinitions'))]",
        "input": "[variables('policyDefinitions')[copyIndex()].name]"
      }
    },
    "policySetDefinitionNames": {
      "type": "array",
      "copy": {
        "count": "[length(variables('policySetDefinitions'))]",
        "input": "[variables('policySetDefinitions')[copyIndex()].name]"
      }
    }
  }
}